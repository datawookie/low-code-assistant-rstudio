lca_main_ui <- function(id) {
  ns <- NS(id)

  tagList(
    shinyjs::useShinyjs(),
    tags$head(tags$style(
      "#header-bar { margin: 0 -15px; font-size: 2.5rem; text-transform: uppercase; background: #2d71c7; color: #fff; height: 70px; padding: 10px 20px; display: flex; align-items: center; flex-direction: row-reverse; }
       #header-bar img { margin-left: 10px; }"
    )),
    div(
      id = "header-bar",
      img(height = "100%", src = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzk3IiBoZWlnaHQ9IjM5NyIgdmlld0JveD0iMCAwIDM5NyAzOTciIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTkzLjg0MSA3My4wNzUzTDI2Ny42NDEgMzAuNjYzN0MyNzAuMTEgMjkuMjM2NSAyNzIuMDQgMjcuMDM0MiAyNzMuMTI5IDI0LjM5ODdDMjc0LjIxOSAyMS43NjMxIDI3NC40MDggMTguODQxNiAyNzMuNjY4IDE2LjA4NzRDMjcyLjkyOCAxMy4zMzMxIDI3MS4yOTkgMTAuOTAwMiAyNjkuMDM1IDkuMTY2MTJDMjY2Ljc3MSA3LjQzMjAyIDI2My45OTggNi40OTM2NyAyNjEuMTQ2IDYuNDk2NjhDMjU4Ljg2NSA2LjQ4Nzc0IDI1Ni42MjYgNy4xMDIxIDI1NC42NjkgOC4yNzMzOEwxODAuODY5IDUwLjY0NjhDMTc5LjM5MSA1MS40OTUgMTc4LjA5NSA1Mi42MjcxIDE3Ny4wNTYgNTMuOTc3OEMxNzYuMDE2IDU1LjMyODYgMTc1LjI1NCA1Ni44NzE1IDE3NC44MTMgNTguNTE3OEMxNzQuMzU4IDYwLjE1NjkgMTc0LjIzNyA2MS44NzA2IDE3NC40NTcgNjMuNTU3NEMxNzQuNjc3IDY1LjI0NDIgMTc1LjIzMyA2Ni44Njk3IDE3Ni4wOTMgNjguMzM3NEMxNzcuODIyIDcxLjMxNDkgMTgwLjY2MiA3My40ODU2IDE4My45ODggNzQuMzczN0MxODcuMzE1IDc1LjI2MTggMTkwLjg1OCA3NC43OTQ5IDE5My44NDEgNzMuMDc1M1oiIGZpbGw9IiM1Mjg4QzciLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNTEuNDg3IDMzMi4wMTZDMTUyLjcwMyAzMzAuODI3IDE1My42NjggMzI5LjQwNyAxNTQuMzI1IDMyNy44MzhDMTU0Ljk4MSAzMjYuMjY5IDE1NS4zMTUgMzI0LjU4NCAxNTUuMzA3IDMyMi44ODRDMTU1LjI3MiAzMTkuNDQgMTUzLjg3MyAzMTYuMTUxIDE1MS40MTYgMzEzLjczN0MxNDguOTU5IDMxMS4zMjMgMTQ1LjY0NiAzMDkuOTgyIDE0Mi4yMDIgMzEwLjAwN0g1Ni4zODUzQzU0LjY1MTMgMzA5Ljk0MSA1Mi45MjE4IDMxMC4yMjUgNTEuMzAwMSAzMTAuODQyQzQ5LjY3ODUgMzExLjQ2IDQ4LjE5ODEgMzEyLjM5OCA0Ni45NDc4IDMxMy42MDFDNDUuNjk3NCAzMTQuODA0IDQ0LjcwMjcgMzE2LjI0NyA0NC4wMjMzIDMxNy44NDRDNDMuMzQzOCAzMTkuNDQxIDQyLjk5MzYgMzIxLjE1OCA0Mi45OTM2IDMyMi44OTNDNDIuOTkzNiAzMjQuNjI5IDQzLjM0MzggMzI2LjM0NiA0NC4wMjMzIDMyNy45NDNDNDQuNzAyNyAzMjkuNTM5IDQ1LjY5NzQgMzMwLjk4MiA0Ni45NDc4IDMzMi4xODZDNDguMTk4MSAzMzMuMzg5IDQ5LjY3ODUgMzM0LjMyNyA1MS4zMDAxIDMzNC45NDVDNTIuOTIxOCAzMzUuNTYyIDU0LjY1MTMgMzM1Ljg0NiA1Ni4zODUzIDMzNS43NzlIMTQyLjIwMkMxNDUuNjcgMzM1Ljc4OSAxNDkuMDA0IDMzNC40MzggMTUxLjQ4NyAzMzIuMDE2Wk01MS42NDc0IDIxOC4zNDVDNTIuNzc3MyAyMjAuMzI1IDU0LjQwODQgMjIxLjk3MyA1Ni4zNzY4IDIyMy4xMjNDNTguMzQ1MyAyMjQuMjc0IDYwLjU4MTggMjI0Ljg4NiA2Mi44NjE3IDIyNC44OThDNjUuMTMxNSAyMjQuODkyIDY3LjM1OTQgMjI0LjI4NiA2OS4zMTg5IDIyMy4xNEM3Mi4yOTEzIDIyMS40MTEgNzQuNDU4MyAyMTguNTc1IDc1LjM0NjEgMjE1LjI1M0M3Ni4yMzM5IDIxMS45MzEgNzUuNzcwNCAyMDguMzkzIDc0LjA1NjggMjA1LjQxMUwzMS42MjYxIDEzMS43MDdDMjkuODc2MyAxMjguNzg5IDI3LjA0OTEgMTI2LjY3NyAyMy43NTUxIDEyNS44MjdDMjAuNDYxMiAxMjQuOTc3IDE2Ljk2NSAxMjUuNDU3IDE0LjAyMTggMTI3LjE2M0MxMS4wNzg3IDEyOC44NjkgOC45MjQ5NiAxMzEuNjY1IDguMDI1ODYgMTM0Ljk0NkM3LjEyNjc3IDEzOC4yMjcgNy41NTQ1MSAxNDEuNzMgOS4yMTY2OSAxNDQuNjk4TDUxLjY0NzQgMjE4LjM0NVpNODcuNDQ4OSAyODkuODUyQzkwLjMwOSAyODkuODcxIDkzLjA5NDYgMjg4Ljk0MiA5NS4zNzAyIDI4Ny4yMDlDOTcuNjQ1NyAyODUuNDc2IDk5LjI4MjcgMjgzLjAzOCAxMDAuMDI1IDI4MC4yNzZDMTAwLjc2NyAyNzcuNTE0IDEwMC41NzMgMjc0LjU4NCA5OS40NzMxIDI3MS45NDRDOTguMzcyOSAyNjkuMzA0IDk2LjQyODYgMjY3LjEwMyA5My45NDQ0IDI2NS42ODVMMjAuMjIwOCAyMjMuMjU1QzE4LjI1OTkgMjIyLjEzNiAxNi4wNDAzIDIyMS41NSAxMy43ODI2IDIyMS41NTRDMTEuNTAyNSAyMjEuNTQ5IDkuMjYwNzkgMjIyLjE0MSA3LjI4MDA5IDIyMy4yN0M1LjI5OTM4IDIyNC40IDMuNjQ4NjggMjI2LjAyOCAyLjQ5MTk3IDIyNy45OTNDMS42MzEzNyAyMjkuNDc4IDEuMDc0OTggMjMxLjExOSAwLjg1NTIyMyAyMzIuODIxQzAuNjM1NDY3IDIzNC41MjQgMC43NTY3NDIgMjM2LjI1MyAxLjIxMTk4IDIzNy45MDhDMS42NTQzMSAyMzkuNTM4IDIuNDE1NjEgMjQxLjA2NSAzLjQ1MTg0IDI0Mi40QzQuNDg4MDcgMjQzLjczNSA1Ljc3ODY2IDI0NC44NTEgNy4yNDg5NSAyNDUuNjgzTDgwLjk1MzQgMjg4LjIwOUM4Mi45MzMzIDI4OS4zMjcgODUuMTc2IDI4OS44OTQgODcuNDQ4OSAyODkuODUyWk03NS4yNDEzIDE1NS40NTNDNzguNjc1MSAxNTUuNDAzIDgxLjk0OTggMTUzLjk5NyA4NC4zNTEyIDE1MS41NDJDODYuNzUyNiAxNDkuMDg3IDg4LjA4NTggMTQ1Ljc4MiA4OC4wNjAzIDE0Mi4zNDhWNTYuNTEyMUM4OC4xMjcgNTQuNzc4MiA4Ny44NDMyIDUzLjA0ODYgODcuMjI1NyA1MS40MjdDODYuNjA4MiA0OS44MDUzIDg1LjY2OTggNDguMzI1IDg0LjQ2NjYgNDcuMDc0NkM4My4yNjM1IDQ1LjgyNDIgODEuODIwMyA0NC44Mjk1IDgwLjIyMzcgNDQuMTUwMUM3OC42MjcgNDMuNDcwNyA3Ni45MDk2IDQzLjEyMDUgNzUuMTc0NCA0My4xMjA1QzczLjQzOTIgNDMuMTIwNSA3MS43MjE4IDQzLjQ3MDcgNzAuMTI1MSA0NC4xNTAxQzY4LjUyODQgNDQuODI5NSA2Ny4wODUzIDQ1LjgyNDIgNjUuODgyMSA0Ny4wNzQ2QzY0LjY3OSA0OC4zMjUgNjMuNzQwNiA0OS44MDUzIDYzLjEyMzEgNTEuNDI3QzYyLjUwNTYgNTMuMDQ4NiA2Mi4yMjE3IDU0Ljc3ODIgNjIuMjg4NSA1Ni41MTIxVjE0Mi4zNDhDNjIuMjc4NSAxNDQuMDU5IDYyLjYwNTUgMTQ1Ljc1NSA2My4yNTEgMTQ3LjM0QzYzLjg5NjUgMTQ4LjkyNCA2NC44NDc4IDE1MC4zNjYgNjYuMDUwNiAxNTEuNTgzQzY3LjI1MzMgMTUyLjggNjguNjg0MSAxNTMuNzY4IDcwLjI2MSAxNTQuNDMyQzcxLjgzNzkgMTU1LjA5NyA3My41MzAyIDE1NS40NDMgNzUuMjQxMyAxNTUuNDUzWk0yNTUuNzU4IDg4LjI0NDRIMzQxLjU1NkMzNDQuOTcxIDg4LjI0NDQgMzQ4LjI0NiA4Ni44ODc4IDM1MC42NjEgODQuNDczQzM1My4wNzUgODIuMDU4MyAzNTQuNDMyIDc4Ljc4MzEgMzU0LjQzMiA3NS4zNjgxQzM1NC40MzIgNzEuOTUzMSAzNTMuMDc1IDY4LjY3NzkgMzUwLjY2MSA2Ni4yNjMyQzM0OC4yNDYgNjMuODQ4NCAzNDQuOTcxIDYyLjQ5MTggMzQxLjU1NiA2Mi40OTE4SDI1NS43NThDMjUyLjM0MyA2Mi40OTE4IDI0OS4wNjggNjMuODQ4NCAyNDYuNjUzIDY2LjI2MzJDMjQ0LjIzOCA2OC42Nzc5IDI0Mi44ODIgNzEuOTUzMSAyNDIuODgyIDc1LjM2ODFDMjQyLjg4MiA3OC43ODMxIDI0NC4yMzggODIuMDU4MyAyNDYuNjUzIDg0LjQ3M0MyNDkuMDY4IDg2Ljg4NzggMjUyLjM0MyA4OC4yNDQ0IDI1NS43NTggODguMjQ0NFpNMzg5LjYwMyAxNTEuNDYxTDMxNS45MzcgMTA5LjAzQzMxMi45NTEgMTA3LjMwOSAzMDkuNDA1IDEwNi44NDIgMzA2LjA3NSAxMDcuNzNDMzAyLjc0NSAxMDguNjE4IDI5OS45MDIgMTEwLjc4OSAyOTguMTcgMTEzLjc2OEMyOTcuMzIxIDExNS4yNDMgMjk2Ljc3MiAxMTYuODcxIDI5Ni41NTIgMTE4LjU1OEMyOTYuMzMzIDEyMC4yNDYgMjk2LjQ0OSAxMjEuOTYgMjk2Ljg5MiAxMjMuNjAzQzI5Ny4zMzYgMTI1LjI0NiAyOTguMDk5IDEyNi43ODUgMjk5LjEzNyAxMjguMTMzQzMwMC4xNzYgMTI5LjQ4MSAzMDEuNDcgMTMwLjYxMSAzMDIuOTQ2IDEzMS40NThMMzc2LjYzMSAxNzMuODdDMzc5LjYxNyAxNzUuNTkxIDM4My4xNjMgMTc2LjA1OCAzODYuNDkzIDE3NS4xN0MzODkuODIzIDE3NC4yODIgMzkyLjY2NSAxNzIuMTExIDM5NC4zOTggMTY5LjEzMkMzOTYuMTA0IDE2Ni4xNTMgMzk2LjU1OCAxNjIuNjE3IDM5NS42NTggMTU5LjMwNEMzOTQuNzU5IDE1NS45OSAzOTIuNTgxIDE1My4xNjkgMzg5LjYwMyAxNTEuNDYxWk0zNDUuMjQzIDE3OS44MTFDMzQ0LjA5NSAxNzcuODUxIDM0Mi40NTUgMTc2LjIyNSAzNDAuNDg0IDE3NS4wOTZDMzM4LjUxMyAxNzMuOTY2IDMzNi4yODEgMTczLjM3MiAzMzQuMDA5IDE3My4zNzNDMzMxLjczNSAxNzMuMzc4IDMyOS41MDMgMTczLjk4IDMyNy41MzUgMTc1LjExOUMzMjUuNTY3IDE3Ni4yNTkgMzIzLjkzMyAxNzcuODk1IDMyMi43OTcgMTc5Ljg2NUMzMjEuNjYxIDE4MS44MzUgMzIxLjA2MyAxODQuMDY5IDMyMS4wNjMgMTg2LjM0M0MzMjEuMDYyIDE4OC42MTcgMzIxLjY2IDE5MC44NTEgMzIyLjc5NSAxOTIuODIyTDM2NS4yNDUgMjY2LjYwMkMzNjYuMzkxIDI2OC41NjUgMzY4LjAzMSAyNzAuMTk0IDM3MC4wMDIgMjcxLjMyNkMzNzEuOTczIDI3Mi40NTkgMzc0LjIwNSAyNzMuMDU3IDM3Ni40NzggMjczLjA2QzM3OC43NDEgMjczLjAzNSAzODAuOTYxIDI3Mi40NDQgMzgyLjkzNiAyNzEuMzRDMzg1LjkyMSAyNjkuNTc3IDM4OC4wOSAyNjYuNzA4IDM4OC45NzMgMjYzLjM1NUMzODkuODQgMjYwLjA1NiAzODkuMzczIDI1Ni41NDkgMzg3LjY3MyAyNTMuNTkyTDM0NS4yNDMgMTc5LjgxMVpNMjgzLjIzIDI5OC4yNThDMjgxLjc1NyAyOTcuNDAzIDI4MC4xMyAyOTYuODQ5IDI3OC40NDEgMjk2LjYyN0MyNzYuNzUzIDI5Ni40MDYgMjc1LjAzNyAyOTYuNTIxIDI3My4zOTMgMjk2Ljk2N0MyNzEuNzUgMjk3LjQxMyAyNzAuMjExIDI5OC4xODEgMjY4Ljg2NiAyOTkuMjI2QzI2Ny41MjEgMzAwLjI3IDI2Ni4zOTcgMzAxLjU3MSAyNjUuNTU5IDMwMy4wNTNMMjIzLjEwOSAzNzYuNzAxQzIyMS40MTUgMzc5LjY5IDIyMC45NjIgMzgzLjIyNCAyMjEuODQ4IDM4Ni41NDRDMjIyLjczNCAzODkuODYzIDIyNC44ODggMzkyLjcwMiAyMjcuODQ3IDM5NC40NDlDMjI5LjMxNyAzOTUuMzA2IDIzMC45NDQgMzk1Ljg2NCAyMzIuNjMxIDM5Ni4wOUMyMzQuMzE5IDM5Ni4zMTYgMjM2LjAzNCAzOTYuMjA2IDIzNy42NzkgMzk1Ljc2NkMyMzkuMzI0IDM5NS4zMjUgMjQwLjg2NSAzOTQuNTYzIDI0Mi4yMTQgMzkzLjUyNEMyNDMuNTYyIDM5Mi40ODUgMjQ0LjY5MiAzOTEuMTg5IDI0NS41MzcgMzg5LjcxMUwyODcuOTY4IDMxNi4wMDZDMjg5LjY3NSAzMTMuMDMgMjkwLjEzNCAzMDkuNDk4IDI4OS4yNDcgMzA2LjE4NEMyODguMzU5IDMwMi44NyAyODYuMTk2IDMwMC4wNDEgMjgzLjIzIDI5OC4zMTZWMjk4LjI1OFpNMjIzLjAxMyAzMjcuNjc5QzIyMi4xNjIgMzI2LjIgMjIxLjAyOCAzMjQuOTAyIDIxOS42NzUgMzIzLjg2MUMyMTguMzIyIDMyMi44MjEgMjE2Ljc3NyAzMjIuMDU3IDIxNS4xMjkgMzIxLjYxM0MyMTMuNDgxIDMyMS4xNyAyMTEuNzYxIDMyMS4wNTUgMjEwLjA2OSAzMjEuMjc2QzIwOC4zNzYgMzIxLjQ5OCAyMDYuNzQ0IDMyMi4wNSAyMDUuMjY1IDMyMi45MDNMMTMxLjU4IDM2NS4zMTVDMTMwLjA1MiAzNjYuMTM3IDEyOC43MDUgMzY3LjI1NyAxMjcuNjE5IDM2OC42MUMxMjYuNTMzIDM2OS45NjIgMTI1LjczIDM3MS41MTkgMTI1LjI1NyAzNzMuMTg4QzEyNC43ODMgMzc0Ljg1NyAxMjQuNjUxIDM3Ni42MDUgMTI0Ljg2NiAzNzguMzI2QzEyNS4wODEgMzgwLjA0NyAxMjUuNjM5IDM4MS43MDggMTI2LjUwOCAzODMuMjA5QzEyNy4zNzcgMzg0LjcxMSAxMjguNTM5IDM4Ni4wMjIgMTI5LjkyNSAzODcuMDY2QzEzMS4zMSAzODguMTEgMTMyLjg5MiAzODguODY1IDEzNC41NzUgMzg5LjI4NkMxMzYuMjU3IDM4OS43MDcgMTM4LjAwOCAzODkuNzg1IDEzOS43MjIgMzg5LjUxN0MxNDEuNDM2IDM4OS4yNDkgMTQzLjA3OCAzODguNjM5IDE0NC41NTIgMzg3LjcyNEwyMTguMjM3IDM0NS4zMTJDMjE5LjcxMyAzNDQuNDcyIDIyMS4wMDcgMzQzLjM0OCAyMjIuMDQ3IDM0Mi4wMDZDMjIzLjA4NiAzNDAuNjYzIDIyMy44NSAzMzkuMTI4IDIyNC4yOTQgMzM3LjQ4OUMyMjQuNzM4IDMzNS44NSAyMjQuODUzIDMzNC4xNCAyMjQuNjMzIDMzMi40NTZDMjI0LjQxNCAzMzAuNzczIDIyMy44NjMgMzI5LjE0OSAyMjMuMDEzIDMyNy42NzlaTTMyMi43NTcgMjQyLjc0MUMzMTkuMzExIDI0Mi43ODEgMzE2LjAyMiAyNDQuMTg1IDMxMy42MDkgMjQ2LjY0NUMzMTEuMTk2IDI0OS4xMDUgMzA5Ljg1NSAyNTIuNDIgMzA5Ljg4MSAyNTUuODY2VjM0MS43MDJDMzA5Ljg2OCAzNDMuNDA0IDMxMC4xOTEgMzQ1LjA5MiAzMTAuODMyIDM0Ni42N0MzMTEuNDcyIDM0OC4yNDggMzEyLjQxOCAzNDkuNjgzIDMxMy42MTMgMzUwLjg5NUMzMTQuODA5IDM1Mi4xMDcgMzE2LjIzMyAzNTMuMDcxIDMxNy44MDEgMzUzLjczM0MzMTkuMzcgMzU0LjM5NCAzMjEuMDU0IDM1NC43NCAzMjIuNzU3IDM1NC43NUMzMjQuNDU1IDM1NC43NTcgMzI2LjEzNiAzNTQuNDIzIDMyNy43MDIgMzUzLjc2NkMzMjkuMjY4IDM1My4xMSAzMzAuNjg1IDM1Mi4xNDUgMzMxLjg3IDM1MC45MjlDMzMzLjA4NCAzNDkuNzE5IDMzNC4wNDcgMzQ4LjI4MSAzMzQuNzAyIDM0Ni42OTdDMzM1LjM1OCAzNDUuMTEzIDMzNS42OTQgMzQzLjQxNiAzMzUuNjkxIDM0MS43MDJWMjU1LjkyM0MzMzUuNzAzIDI1NC4yMTIgMzM1LjM3OSAyNTIuNTE1IDMzNC43MzUgMjUwLjkzQzMzNC4wOTIgMjQ5LjM0NCAzMzMuMTQzIDI0Ny45MDEgMzMxLjk0MiAyNDYuNjgyQzMzMC43NDEgMjQ1LjQ2MyAzMjkuMzEyIDI0NC40OTMgMzI3LjczNiAyNDMuODI3QzMyNi4xNiAyNDMuMTYgMzI0LjQ2OCAyNDIuODExIDMyMi43NTcgMjQyLjc5OFYyNDIuNzQxWk0xMTMuNjQxIDk4Ljg2NjRDMTE2LjYxOSAxMDAuNTYgMTIwLjE0NiAxMDEuMDExIDEyMy40NTQgMTAwLjEyQzEyNi43NjMgOTkuMjI5NiAxMjkuNTg3IDk3LjA2OTYgMTMxLjMxMiA5NC4xMDk1TDE3My43NjIgMjAuMzg1OEMxNzUuNDY0IDE3LjM5NDIgMTc1LjkxOCAxMy44NTE4IDE3NS4wMjMgMTAuNTI4QzE3NC4zNzEgOC4wNDU2OCAxNzIuOTk2IDUuODEzMzkgMTcxLjA3MSA0LjExNTIyQzE2OS4xNDcgMi40MTcwNSAxNjYuNzYxIDEuMzI5NzkgMTY0LjIxNyAwLjk5MTgwNUMxNjEuNjczIDAuNjUzODE3IDE1OS4wODYgMS4wODAzOCAxNTYuNzg1IDIuMjE3MjJDMTU0LjQ4NCAzLjM1NDA1IDE1Mi41NzMgNS4xNDk3NSAxNTEuMjk2IDcuMzc1OEwxMDguOTAzIDgxLjExODVDMTA3LjE3OCA4NC4xMDA0IDEwNi43MDkgODcuNjQ1MyAxMDcuNTk3IDkwLjk3MzVDMTA4LjQ4NiA5NC4zMDE4IDExMC42NiA5Ny4xNDA4IDExMy42NDEgOTguODY2NFoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo="),
      div("Domino R Assistant")
    ),
    page_data_select_ui(ns("data")),
    page_xforms_ui(ns("xforms"))
  )
}

lca_main_server <- function(id, data_name) {
  moduleServer(
    id,
    function(input, output, session) {

      data_mod <- page_data_select_server("data")
      data_name <- data_mod$data_name

      xforms_mod <- page_xforms_server("xforms", data_name)

      observeEvent(data_name(), {
        data_mod$hide()
        xforms_mod$show()
      })

      data_mod$show()
    }
  )
}
